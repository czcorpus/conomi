<overview>
    <div if={ state.error != null }>Error: { state.error.response ? JSON.stringify(state.error.response.data) : JSON.stringify(state.error) }</div>
    <div if={ state.counts == null && state.error == null }>Loading...</div>
    <div if={ state.counts != null && state.error == null }>
        <table>
            <thead>
                <tr>
                    <th class="col-mark"></th>
                    <th class="col-source">Source</th>
                    <th>Created</th>
                    <th>Last</th>
                    <th>Recent</th>
                    <th>Critical</th>
                    <th>Warning</th>
                    <th>Info</th>
                </tr>
            </thead>
            <tbody>
                <tr each={ count in state.counts }>
                    <td class="col-mark">
                        <img class="mark" if={ count.escalated } src="{props.baseUrl}/ui/assets/img/mark.png">
                    </td>
                    <td class="col-source">
                        <a href={`list?app=${count.sourceId.app}&instance=${count.sourceId.instance}&tag=${count.sourceId.tag}`}>
                            { count.sourceId.app } / { count.sourceId.instance } # { count.sourceId.tag }
                        </a>
                    </td>
                    <td>{ count.created }</td>
                    <td>{ count.last }</td>
                    <td>{ count.recent }</td>
                    <td class="critical">{ count.critical }</td>
                    <td class="warning">{ count.warning }</td>
                    <td class="info">{ count.info }</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script>
        import axios from 'axios';

        export default {
            onBeforeMount(props, state) {
                this.state.counts = null;
                this.state.error = null;
                axios.get(props.baseUrl+"/api/overview")
                    .then(resp => this.update({counts: resp.data}))
                    .catch(error => this.update({error}))
            },
        }
    </script>

    <style>
        th, td {
           padding: 0.1em 1em;
        }

        .col-mark {
            width: 1em;
        }

        .col-source {
            padding-left: 0em;
        }

        .mark {
            width: 1em;
            margin: 0 0.5em;
        }
    </style>
</overview>